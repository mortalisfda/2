<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Aventura Gráfica</title>

  <!-- Tipografías -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=Merriweather:wght@300;400;700;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --papel-claro: #f3e0b5;
      --papel-medio: #d9ba7c;
      --borde-oscuro: #3a2b12;
      --borde-medio: #5c4320;
      --tinta: #2b1b0d;

      --margen-escena: clamp(8px, 3vw, 20px);

      --celeste: #000000;
      --celeste-strong: #4e4e4e;
      --negro: #000;
      --blanco: #fff;
    }

    body {
      margin: 0;
      background-image: url('img/FONDO.webp');
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      font-family: "Cinzel Decorative", serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    h1 {
      margin-top: 20px;
      margin-bottom: 5px;
      font-size: 2.5em;
      color: white;
      text-align: center;
      letter-spacing: 2px;
    }

    h2 {
      margin-top: 0;
      margin-bottom: 20px;
      font-size: 1.3em;
      color: white;
      text-align: center;
      font-weight: 400;
    }

    /* ===== Contenedor con estética pergamino ===== */
    #contenedor {
      position: relative;
      aspect-ratio: 1 / 1;
      width: 100vw;
      max-width: 600px;
      border: 18px solid var(--borde-medio);
      box-shadow:
        0 0 0 2px var(--borde-oscuro) inset,
        0 12px 28px rgba(0,0,0,0.55);
      background: linear-gradient(to bottom, var(--papel-claro), var(--papel-medio));
      overflow: hidden;
      display: grid;
      grid-template-rows: 1fr auto auto;
    }

    /* ===== Escena con capas ===== */
    #escena {
      position: relative;
      padding: var(--margen-escena);
      opacity: 0;
      transition: opacity 0.8s ease-in-out;
      cursor: default;
    }
    #escena.clickable { cursor: pointer; }

    #escena-base,
    #escena-sprite,
    #escena-sprite2{
      position: absolute;
      inset: var(--margen-escena);
      background-repeat: no-repeat;
      background-position: center;
      background-size: contain;
      pointer-events: none;
      opacity: 1;
      transition: opacity .4s ease;
    }
    #escena-base   { z-index: 1; }
    #escena-sprite { z-index: 2; }
    #escena-sprite2{ z-index: 3; }

    #escena::before {
      content: "";
      position: absolute;
      inset: var(--margen-escena);
      box-shadow: inset 0 0 12px rgba(0,0,0,0.18);
      border-radius: 2px;
      z-index: 0;
      pointer-events: none;
    }

    /* ===== Latidos ===== */
    @keyframes heartbeatSoft {
      0%   { transform: scale(1); }
      12%  { transform: scale(0.985); }
      24%  { transform: scale(1.012); }
      36%  { transform: scale(0.990); }
      48%  { transform: scale(1.008); }
      60%  { transform: scale(1); }
      100% { transform: scale(1); }
    }
    .anim-heart-soft {
      animation: heartbeatSoft 7s cubic-bezier(.3,0,.2,1) infinite;
      transform-origin: 50% 60%;
    }

    @keyframes heartbeatTiny {
      0%   { transform: scale(1); }
      20%  { transform: scale(0.995); }
      30%  { transform: scale(1.004); }
      40%  { transform: scale(0.997); }
      50%  { transform: scale(1.006); }
      60%,100% { transform: scale(1); }
    }
    .anim-heart-tiny {
      animation: heartbeatTiny 8s cubic-bezier(.3,0,.2,1) infinite;
      transform-origin: 50% 60%;
    }

    /* ===== Desplazamientos en X (viento) — acortados ===== */
    @keyframes panXslow {
      0%   { transform: translateX(-2%); }
      50%  { transform: translateX( 2%); }
      100% { transform: translateX(-2%); }
    }
    @keyframes panXslowWide {
      0%   { transform: translateX(-4%); }
      50%  { transform: translateX( 4%); }
      100% { transform: translateX(-4%); }
    }
    @keyframes panXtiny {
      0%   { transform: translateX(-1%); }
      50%  { transform: translateX( 1%); }
      100% { transform: translateX(-1%); }
    }
    .anim-pan-x        { animation: panXslow     30s ease-in-out infinite; }
    .anim-pan-x-slow   { animation: panXslow     24s ease-in-out infinite; }
    .anim-pan-x-slower { animation: panXslowWide 36s ease-in-out infinite; }
    .anim-pan-x-tiny   { animation: panXtiny     28s ease-in-out infinite; }

    /* ===== Variante pantalla 5 más notoria (si la usás) ===== */
    @keyframes panXwide {
      0%   { transform: translateX(0%); }
      50%  { transform: translateX( 1.5%); }
      100% { transform: translateX(-1.5%); }
    }
    .anim-pan-x-bold { animation: panXwide 8s ease-in-out infinite; }

    /* ===== Subir + achicar (Pantalla 7) ===== */
    @keyframes riseShrink {
      0%   { transform: translateY(0) scale(1); }
      100% { transform: translateY(-4%) scale(0.95); }
    }
    .anim-rise-shrink { animation: riseShrink 10s ease-in forwards; transform-origin: 40% 60%; }

    /* ===== Brillo azul (Pantalla 8 / sprite2) ===== */
    @keyframes blueBlink {
      0%, 100% { filter: drop-shadow(0 0 0 rgba(80,180,255,0.0)) drop-shadow(0 0 0 rgba(80,180,255,0.0)); }
      50%      { filter: drop-shadow(0 0 8px rgba(80,180,255,0.9)) drop-shadow(0 0 16px rgba(80,180,255,0.6)); }
    }
    .anim-blue-blink { animation: blueBlink 1.6s ease-in-out infinite; }

    /* ===== Twinkle (Pantalla 9) ===== */
    @keyframes twinkle { 0%, 100% { opacity: 0.65; } 50% { opacity: 1; } }
    .anim-twinkle { animation: twinkle 1.8s ease-in-out infinite; }

    @media (prefers-reduced-motion: reduce) {
      .anim-heart-soft,
      .anim-heart-tiny,
      .anim-pan-x,
      .anim-pan-x-slow,
      .anim-pan-x-slower,
      .anim-pan-x-tiny,
      .anim-pan-x-bold,
      .anim-rise-shrink,
      .anim-blue-blink,
      .anim-twinkle { animation: none !important; }
    }

    /* ===== Caja de texto & botones ===== */
    #cajaTexto {
      background: linear-gradient(to bottom, var(--papel-claro), var(--papel-medio));
      border: 2px solid var(--borde-oscuro);
      border-top-width: 3px;
      border-bottom-width: 3px;
      box-shadow:
        0 3px 0 var(--borde-oscuro),
        inset 0 0 10px rgba(255,255,255,0.20),
        inset 0 0 25px rgba(0,0,0,0.35);
      padding: 10px 50px;
      text-align: center;
      font-family: "Merriweather", serif;
      font-size: 1rem;
      line-height: 1.7;
      color: var(--tinta);
      text-shadow: 0 0 2px rgba(255,255,255,0.15);
      min-height: 80px;
    }
    .maquina span { border-right: 2px solid var(--borde-oscuro); display: inline; animation: blink 0.8s infinite; }
    @keyframes blink { 50% { border-color: transparent; } }

    .botones {
      display: flex;
      justify-content: space-between;
      gap: 14px;
      padding: 14px 22px;
      background: linear-gradient(to bottom, #ead8ad 0%, #d9ba7c 100%);
      border-top: 3px solid var(--borde-medio);
      border-bottom: 3px solid var(--borde-medio);
      box-shadow: inset 0 0 15px rgba(0,0,0,0.25);
    }
    .btn {
      flex: 1;
      padding: 12px 14px;
      font-size: 1.02rem;
      border: 2px solid var(--borde-oscuro);
      background: linear-gradient(to bottom, var(--papel-claro), var(--papel-medio));
      font-family: "Cinzel Decorative", serif;
      color: var(--tinta);
      cursor: pointer;
      letter-spacing: 0.5px;
      box-shadow: 0 3px 0 var(--borde-oscuro), inset 0 0 10px rgba(255,255,255,0.2);
      transition: all 0.2s ease;
      text-transform: none;
    }
    .btn:hover { background: linear-gradient(to bottom, #fff2c9, #e3c890); transform: translateY(-2px); box-shadow: 0 6px 8px rgba(0,0,0,0.22); }
    .btn:active { transform: translateY(1px); box-shadow: inset 0 0 8px rgba(0,0,0,0.25); }

    @keyframes oldGlow { 0%,100% { box-shadow: 0 0 6px rgba(200,170,90,0.5), 0 0 12px rgba(220,190,120,0.25);} 50% { box-shadow: 0 0 12px rgba(230,200,130,0.85), 0 0 22px rgba(240,210,140,0.55);} }
    .glow { animation: oldGlow 1.8s ease-in-out infinite; }
    .no-glow { animation: none !important; }

    @media (max-width: 500px) {
      #cajaTexto { font-size: 0.95rem; }
      .btn { font-size: 0.95rem; padding: 10px 12px; }
    }

    .visualmente-hidden,
    .visually-hidden {
      position: absolute !important;
      left: -9999px !important;
      width: 1px; height: 1px; overflow: hidden;
    }
  </style>
</head>

<body>
  <h1>Mortalis</h1>
  <h2>La historia de Selen</h2>

  <!-- AUDIO: música de fondo -->
  <audio id="bgAudio" class="visualmente-hidden" src="Sonidos/Sonido1.mp3" preload="auto" loop></audio>
  <!-- AUDIO: SFX click/avanzar -->
  <audio id="sfxClick" class="visualmente-hidden" src="Sonidos/SonidoAvanzar.mp3" preload="auto"></audio>
  <!-- AUDIO: SFX pasar página -->
  <audio id="sfxPage" class="visualmente-hidden" src="Sonidos/SonidoEscribir.mp3" preload="auto"></audio>

  <div id="contenedor">
    <div id="escena">
      <div id="escena-base" aria-hidden="true"></div>
      <div id="escena-sprite" aria-label="Elemento animado"></div>
      <div id="escena-sprite2" aria-label="Capa deslizante"></div>
    </div>

    <div id="cajaTexto"></div>
    <div class="botones" id="botonera"></div>
  </div>

  <script>
    /* AUDIO */
    const bgAudio  = document.getElementById('bgAudio');
    const sfxClick = document.getElementById('sfxClick');
    const sfxPage  = document.getElementById('sfxPage');

    bgAudio.volume  = 0.025;
    sfxClick.volume = 0.70;  // 70%
    sfxPage.volume  = 0.90;  // 90%

    function playSFX(el) {
      try {
        el.currentTime = 0;
        el.play();
      } catch(e) { /* silencio si el navegador bloquea */ }
    }

    /* ▶️ NUEVO: reproducir por duración fija (13s) */
    function playSFXFor(el, ms) {
      try {
        if (el._timer) { clearTimeout(el._timer); el._timer = null; }
        el.loop = true;
        el.currentTime = 0;
        el.play();
        el._timer = setTimeout(() => {
          el.pause();
          el.loop = false;
          el.currentTime = 0;
          el._timer = null;
        }, ms);
      } catch(e) { /* ignorar bloqueos */ }
    }

    let audioDesbloqueado = false;
    async function iniciarAudio() {
      if (audioDesbloqueado) return;
      try {
        await bgAudio.play();
        audioDesbloqueado = true;
        ['pointermove','click','touchstart'].forEach(e=>window.removeEventListener(e,iniciarAudio));
        // pequeño fade-in a la música
        let v = 0.0;
        bgAudio.volume = v;
        const fade = setInterval(() => {
          v += 0.05; bgAudio.volume = Math.min(v, 0.35);
          if (v >= 0.35) clearInterval(fade);
        }, 80);
      } catch (e) { audioDesbloqueado = false; }
    }
    ['pointermove','click','touchstart'].forEach(e=>window.addEventListener(e,iniciarAudio,{passive:true}));
    document.addEventListener('visibilitychange', () => {
      if (!audioDesbloqueado) return;
      if (document.hidden) bgAudio.pause(); else bgAudio.play().catch(()=>{});
    });

    /* Reproducir SonidoAvanzar en cada click de botones o escena clickable */
    document.addEventListener('click', (ev) => {
      const t = ev.target;
      if (t.closest('.btn') || t.closest('#escena.clickable')) {
        playSFX(sfxClick);
      }
    }, true);

    /* HISTORIA */
    const pantallas = [
      { texto: "Bienvenido a esta aventura", mas: "Vas a conocer la historia de Selen Aru" },
      { texto: "Las IA ayudaron mucho a las personas pero también las debilitaron física y emocionalmente, poco a poco fueron aislándose cada vez mas...", mas: "Su uso excesivo promovió también la automedicación, y las personas se volvieron resistentes a los medicamentos por eso se aislaron por miedo a enfermarse y no conseguir una cura." },
      { texto: "Convencida de que la medicina natural es la solución decide salir y comenzar a cultivar y cosechar sus propias plantas para obtener medicina y alimentos", mas: "Ella lo hacia para sus seres queridos que fueron afectados por el abuso de medicamentos, pero en el fondo ella quería ayudar a todos tener símbolos tallados." },
      { texto: "Selen decide salir con una mochila llena de semillas a plantar por todas partes y a animar a las personas a cuidarlas entre todos.", mas: "les entregaba frascos con hiervas curativas a las personas a cambio de plantar en el frente de las casas, aunque un poco dudosas deciden que ayudarla ya que era una persona muy querida en el pueblo." },
      { texto: "Pasaron años en los que Selen acostumbraba a ir a las plazas a cuidar las plantas, enseñar lo que sabe y compartir una merienda con las personas", mas: "Un día se reúne todo el pueblo a su alrededor a festejar  y agradecerle por como los ayudo a cambiar y salir del aislamiento." },
      { texto: "Ella era una anciana muy sabia y comenzo a escribir un libro en el que dejaria todo su concoimiento para que las personas puedan difundirlo y ayudar a mucha gente", mas: "Lamentablemente Selen era muy mayor y fallecio al poco tiempo de terminar su libro, no fue vivido como una pérdida común. La comunidad entendió que, al morir, su energía no desaparecería sino que de alguna forma permanecería" },
      { texto: "El pueblo decide reunirse en el arbol central, y llevar con ellos el cristal que identificaba a cada familia", mas: "Al llegar el atardecer todas las familias se acercaron al arbol donde descansaba el cuerpo de Selen." },
      { texto: "Cada familia elegio a una persona que colocaría el cristal en el arbol", mas: "Al unir todos los cristales el lugar se inundo de luz y alegría y las personas comenzaron a experimentar recuerdos y sentimientos con la energía de Selen" },
      { texto: "Todos los años se celebra y recuerda su legado, su energía, al condensarse en el Cristal Mayor de Memoria, no desaparece sino que se convierte en un faro para las futuras generaciones asegurando que su memoria no se pierda.", mas: "Click en el cristal para conocer mas." }
    ];

    let indice = 0;
    let mostrandoMas = false;

    const escena = document.getElementById("escena");
    const escenaBase = document.getElementById("escena-base");
    const escenaSprite = document.getElementById("escena-sprite");
    const escenaSprite2 = document.getElementById("escena-sprite2");
    const cajaTexto = document.getElementById("cajaTexto");
    const botonera = document.getElementById("botonera");

    function escribirTexto(texto) {
      cajaTexto.innerHTML = '<div class="maquina"></div>';
      const box = cajaTexto.querySelector('.maquina');
      let i = 0;
      (function step() {
        if (i < texto.length) {
          box.textContent = texto.slice(0, i + 1);
          box.innerHTML = box.textContent + "<span></span>";
          i++; setTimeout(step, 80);
        } else { box.innerHTML = box.textContent; }
      })();
    }

    function limpiarClasesSprites() {
      escenaSprite.style.backgroundImage = "none";
      escenaSprite2.style.backgroundImage = "none";

      const clases = [
        'anim-heart','anim-heart-soft','anim-heart-tiny',
        'anim-pan-x','anim-pan-x-slow','anim-pan-x-slower','anim-pan-x-tiny','anim-pan-x-bold',
        'anim-rise-shrink','anim-blue-blink','anim-twinkle'
      ];
      escenaSprite.classList.remove(...clases);
      escenaSprite2.classList.remove(...clases);
      escenaSprite2.style.filter = '';
      escenaSprite.style.opacity = '';
      escenaSprite2.style.opacity = '';
    }

    function actualizarFondo() {
      const n = indice + 1;
      escena.style.opacity = 0;

      limpiarClasesSprites();

      setTimeout(() => {
        escenaBase.style.backgroundImage = `url('img/Pantalla${n}.webp')`;

        if (n === 2) {
          escenaSprite.style.backgroundImage = `url('img/pantalla2animar1.webp')`;
          escenaSprite.classList.add('anim-heart-soft');

          escenaSprite2.style.backgroundImage = `url('img/pantalla2animar2.webp')`;
          escenaSprite2.classList.add('anim-pan-x');
        }

        if (n === 3) {
          escenaSprite.style.backgroundImage  = `url('img/pantalla3animar1.webp')`;
          escenaSprite.classList.add('anim-heart-soft');

          escenaSprite2.style.backgroundImage = `url('img/pantalla3animar2.webp')`;
          escenaSprite2.classList.add('anim-heart-soft');
        }

        if (n === 4) {
          escenaSprite.style.backgroundImage = `url('img/pantalla4animar1.webp')`;
          escenaSprite.classList.add('anim-heart-soft');
        }

        if (n === 5) {
          escenaSprite.style.backgroundImage = `url('img/pantalla5animar1.webp')`;
          escenaSprite.classList.add('anim-pan-x-bold');
        }

        if (n === 6) {
          escenaSprite.style.backgroundImage  = `url('img/pantalla6animar1.webp')`;
          escenaSprite.classList.add('anim-heart-soft');

          escenaSprite2.style.backgroundImage = `url('img/pantalla6animar2.webp')`;
          escenaSprite2.classList.add('anim-pan-x-tiny');
        }

        if (n === 7) {
          escenaSprite.style.backgroundImage = `url('img/Pantalla7animar1.webp')`;
          escenaSprite.classList.add('anim-rise-shrink');
        }

        if (n === 8) {
          escenaSprite.style.backgroundImage  = `url('img/Pantalla8animar1.webp')`;
          escenaSprite.classList.add('anim-pan-x-tiny');

          escenaSprite2.style.backgroundImage = `url('img/Pantalla8animar2.webp')`;
          escenaSprite2.classList.add('anim-blue-blink');
        }

        if (n === 9) {
          escenaSprite.style.backgroundImage = `url('img/Pantalla9animar1.webp')`;
          escenaSprite.classList.add('anim-twinkle','anim-heart-tiny');
        }

        escena.style.opacity = 1;

        if (n === 9) {
          escena.classList.add("clickable");
          escena.onclick = () => window.open("https://www.instagram.com/elowen_selen/", "_blank");
        } else {
          escena.classList.remove("clickable");
          escena.onclick = null;
        }
      }, 300);
    }

    function renderBotones() {
      botonera.innerHTML =
        `<button class="btn btn-mas no-glow" id="btnMas" onclick="conocerMas()">Conocer más</button>
         <button class="btn btn-continuar" id="btnContinuar" onclick="continuar()">Continuar</button>`;
    }

    function mostrarPantalla() {
      const p = pantallas[indice];
      mostrandoMas = false;
      actualizarFondo();
      escribirTexto(p.texto);
      renderBotones();
    }

    function conocerMas() {
      const p = pantallas[indice];
      if (!mostrandoMas && p.mas) {
        mostrandoMas = true;
        escribirTexto(p.mas);
        document.getElementById('btnMas').classList.add('no-glow');
        document.getElementById('btnContinuar').classList.add('glow');
      }
    }

    function continuar() {
      if (indice < pantallas.length - 1) {
        // ▶️ NUEVO: SonidoEscribir por 13 segundos
        playSFXFor(sfxPage, 13000);

        indice++;
        mostrarPantalla();
      }
    }

    // Inicio
    mostrarPantalla();
  </script>
</body>
</html>
